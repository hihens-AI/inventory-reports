<!DOCTYPE html>
<html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>編輯 666</title>
<style>
    body {font-family: Arial; margin:20px; background:#f5f5f5;}
    h1 {text-align:center; color:#2c3e50;}
    .container {max-width:600px; margin:auto; background:white; padding:20px; border-radius:10px; box-shadow:0 4px 20px rgba(0,0,0,0.1);}
    .field {margin:15px 0;}
    label {display:block; font-weight:bold; margin-bottom:5px; color:#34495e;}
    input {width:100%; padding:12px; border:1px solid #ddd; border-radius:5px; font-size:16px; box-sizing:border-box;}
    button {width:100%; padding:15px; background:#27ae60; color:white; border:none; border-radius:5px; font-size:18px; cursor:pointer;}
    button:hover {background:#219a52;}
    .success {display:none; text-align:center; color:green; font-size:18px; margin-top:20px;}
</style></head><body>
<div class="container">
    <h1>編輯機台資訊</h1>
    <p style="text-align:center;">Part No: <strong>666</strong></p>
    <form id="form"><div class="field"><label>請領單號 (Requisition No)</label><input type="text" name="請領單號 (Requisition No)" value="666"></div><div class="field"><label>Part No</label><input type="text" name="Part No" value="666"></div><div class="field"><label>Applicant</label><input type="text" name="Applicant" value="666"></div><div class="field"><label>Applicant Department</label><input type="text" name="Applicant Department" value="666"></div><div class="field"><label>Applicant ID</label><input type="text" name="Applicant ID" value="666"></div><div class="field"><label>Qty Apply</label><input type="text" name="Qty Apply" value="666"></div><div class="field"><label>Location</label><input type="text" name="Location" value="666"></div><div class="field"><label>Reason</label><input type="text" name="Reason" value="666"></div><div class="field"><label>Cost ID</label><input type="text" name="Cost ID" value="666"></div><div class="field"><label>Process Date</label><input type="text" name="Process Date" value="666"></div><div class="field"><label>Remark</label><input type="text" name="Remark" value="666"></div><button type="submit">儲存修改</button></form>
    <div id="msg" class="success"></div>
</div>
<script>
document.getElementById('form').onsubmit = async function(e) {
    e.preventDefault();
    const data = {};
    new FormData(this).forEach((v, k) => data[k] = v);
    data.part_no = "666";
    try {
        const res = await fetch("https://script.google.com/macros/s/AKfycbx9z5f8g8Y8vZ8w8X8vY8w8X8vY8w8X8vY8w8X8/exec", {
            method: "POST",
            body: JSON.stringify({action:"update", data})
        });
        if (res.ok) {
            document.getElementById('msg').innerHTML = "儲存成功！資料已更新";
            document.getElementById('msg').style.display = "block";
        }
    } catch(err) { alert("儲存失敗，請檢查網路"); }
};
</script>
</body></html>