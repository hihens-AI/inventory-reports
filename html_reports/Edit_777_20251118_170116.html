<!DOCTYPE html>
<html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>編輯 777</title>
<style>
    body {font-family: "Microsoft JhengHei", Arial; margin:0; background:linear-gradient(135deg,#667eea,#764ba2); min-height:100vh; display:flex; align-items:center;}
    .container {max-width:600px; margin:auto; background:white; padding:30px; border-radius:15px; box-shadow:0 10px 30px rgba(0,0,0,0.3);}
    h1 {text-align:center; color:#2c3e50; margin-bottom:10px;}
    .partno {text-align:center; font-size:20px; color:#8e44ad; font-weight:bold; margin-bottom:20px;}
    .field {margin:18px 0;}
    label {display:block; font-weight:bold; margin-bottom:8px; color:#2c3e50;}
    input {width:100%; padding:14px; border:2px solid #ddd; border-radius:8px; font-size:16px; box-sizing:border-box; transition:0.3s;}
    input:focus {border-color:#667eea; outline:none;}
    button {width:100%; padding:18px; background:#27ae60; color:white; border:none; border-radius:8px; font-size:20px; cursor:pointer; margin-top:20px; font-weight:bold;}
    button:hover {background:#219a52;}
    .msg {text-align:center; margin-top:25px; font-size:20px; font-weight:bold; padding:15px; border-radius:8px;}
</style></head><body>
<div class="container">
    <h1>機台資訊編輯</h1>
    <div class="partno">Part No: 777</div>
    <form id="form"><div class="field"><label>請領單號 (Requisition No)</label><input type="text" name="請領單號 (Requisition No)" value="777"></div><div class="field"><label>Part No</label><input type="text" name="Part No" value="777"></div><div class="field"><label>Applicant</label><input type="text" name="Applicant" value="777"></div><div class="field"><label>Applicant Department</label><input type="text" name="Applicant Department" value="777"></div><div class="field"><label>Applicant ID</label><input type="text" name="Applicant ID" value="777"></div><div class="field"><label>Qty Apply</label><input type="text" name="Qty Apply" value="777"></div><div class="field"><label>Location</label><input type="text" name="Location" value="777"></div><div class="field"><label>Reason</label><input type="text" name="Reason" value="777"></div><div class="field"><label>Cost ID</label><input type="text" name="Cost ID" value="777"></div><div class="field"><label>Process Date</label><input type="text" name="Process Date" value="777"></div><div class="field"><label>Remark</label><input type="text" name="Remark" value="777"></div><button type="submit">儲存修改</button></form>
    <div id="msg" class="msg" style="display:none;"></div>
</div>
<script>
document.getElementById('form').onsubmit = async function(e) {
    e.preventDefault();
    const btn = document.querySelector('button');
    btn.textContent = "儲存中...";
    btn.disabled = true;
    const data = {};
    new FormData(this).forEach((v, k) => data[k] = v.trim());
    data["Part No"] = "777";
    try {
        const res = await fetch("https://script.google.com/macros/s/AKfycbyMEzQ404EPM1o4V1SAqGjXfS5eI8cjWBNj4FzcTIshY1IDn7AGnhvB6-c5y7RRQVyfLQ/exec", {
            method: "POST",
            body: JSON.stringify({action:"update", data})
        });
        const msg = document.getElementById('msg');
        if (res.ok && await res.text() === "success") {
            msg.style.display = "block";
            msg.style.background = "#d5f4e6";
            msg.style.color = "#27ae60";
            msg.innerHTML = "儲存成功！資料已即時更新";
        } else {
            msg.style.display = "block";
            msg.style.background = "#fdf2f2";
            msg.style.color = "#e74c3c";
            msg.innerHTML = "儲存失敗，請再試一次";
        }
    } catch(err) {
        document.getElementById('msg').innerHTML = "網路錯誤，請檢查 Wi-Fi";
        document.getElementById('msg').style.display = "block";
        document.getElementById('msg').style.background = "#fdf2f2";
        document.getElementById('msg').style.color = "#e74c3c";
    }
    btn.textContent = "儲存修改";
    btn.disabled = false;
};
</script>
</body></html>